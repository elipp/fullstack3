{"version":3,"sources":["jsonservfuncs.js","index.js"],"names":["baseUrl","axios","get","then","response","data","newObject","post","id","put","delete","Filter","filter","changeHandler","value","onChange","AddPersonDialog","curName","nameChangeHandler","curPhone","phoneChangeHandler","submitHandler","onSubmit","event","target","type","People","persons","filterfunc","delfunc","map","p","name","number","onClick","Notification","notification","err","className","msg","App","useState","setPersons","useEffect","newName","setNewName","newPhone","setNewPhone","setFilter","setNotification","commitMsg","message","timeout","setTimeout","clearTimeout","tout","showMessage","messageText","showError","preventDefault","existing","find","window","confirm","jsonservfuncs","resp","copy","fp","catch","console","log","error","updateExisting","newP","toLowerCase","search","person","e","status","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.1c75f18a.chunk.js","sourcesContent":["import axios from 'axios'\nconst baseUrl = 'http://localhost:3001/api/persons'\n\nconst getAll = () => {\n  const request = axios.get(baseUrl)\n  return request.then(response => response.data)\n}\n\nconst addEntry = newObject => {\n  const request = axios.post(baseUrl, newObject)\n  return request.then(response => response.data)\n}\n\nconst update = (id, newObject) => {\n  const request = axios.put(`${baseUrl}/${id}`, newObject)\n  return request.then(response => response.data)\n}\n\nconst deletePerson = (id) => {\n  const request = axios.delete(`${baseUrl}/${id}`)\n  return request.then(response => response.data)\n}\n\nexport default { getAll, addEntry, update, deletePerson }\n","import React, { useState, useEffect } from 'react'\nimport ReactDOM from 'react-dom'\nimport axios from 'axios'\nimport jsonservfuncs from './jsonservfuncs'\nimport './index.css'\n\nconst Filter = ({filter, changeHandler}) => {\n  return (\n  <form>\n    <div>\n      filter shown entries by: <input value={filter} onChange={changeHandler}/>\n    </div>\n  </form>\n  )\n}\n\nconst AddPersonDialog = ({ curName, nameChangeHandler, curPhone, phoneChangeHandler, submitHandler }) => {\n  return (\n  <form onSubmit={submitHandler}>\n    <div>\n      name: <input value={curName} onChange={(event) => nameChangeHandler(event.target.value)} />\n    </div>\n    <div>\n      phone: <input value={curPhone} onChange={(event) => phoneChangeHandler(event.target.value)} />\n    </div>\n    <div>\n      <button type=\"submit\">add</button>\n    </div>\n  </form>\n  )\n}\n\nconst People = ({persons,filterfunc,delfunc}) => {\n\nreturn (\n  <div>\n    <table>\n      <tbody>\n    {persons.filter(filterfunc).map(p => <tr key={p.name}><td><b>{p.name}</b></td><td>{p.number ? p.number : '-'}</td><td><button onClick={()=>{ delfunc(p) }}>Delete</button></td></tr>)}\n    </tbody>\n    </table>\n  </div>\n)\n}\n\nconst Notification = ({ notification }) => {\n  if (!notification) {\n    return null\n  }\n\n  if (notification.err) {\n  return (\n    <div className=\"error\">\n      {notification.msg}\n    </div>\n  )\n  }\n\n  else {\n    return (\n      <div className=\"success\">\n        {notification.msg}\n      </div>\n    )\n  }\n}\n\nconst App = () => {\n\n  const [ persons, setPersons ] = useState([])\n\n  useEffect(() => {\n    axios\n      .get('http://localhost:3001/api/persons')\n      .then(response => {\n        setPersons(response.data)\n      })\n  }, [])\n\n  const [ newName, setNewName ] = useState('')\n  const [ newPhone, setNewPhone ] = useState('')\n  const [ filter, setFilter ] = useState('')\n\n  const [ notification, setNotification ] = useState(null)\n\n  const commitMsg = (message) => {\n      const timeout = setTimeout(() => {\n        setNotification(null)\n      }, 5000)\n\n      if (notification) {\n        clearTimeout(notification.tout)\n      }\n\n      setNotification({...message, tout: timeout})\n  }\n\n  const showMessage = (messageText) => {\n      commitMsg({msg: messageText, err: false})\n  }\n\n  const showError = (messageText) => {\n      commitMsg({msg: messageText, err: true})\n  }\n\n  const updateExisting = (existing) => {\n    if (existing.number != newPhone) {\n      const ans = window.confirm(`${newName} is already in the phone book! Want to update phone number to ${newPhone}?`)\n      if (ans) {\n        jsonservfuncs.update(existing.id, { name: existing.name, number: newPhone, id: existing.id })\n          .then((resp) => {\n            const copy = [...persons]\n            const fp = copy.find(p => p.id === resp.id)\n            if (fp) {\n              fp.number = resp.number\n              setPersons(copy)\n              showMessage(`Successfully updated ${fp.name}'s number to ${resp.number}!`)\n            }\n          }).catch((err) => {\n            console.log(err)\n            showError(err.response.data.error)\n          })\n      }\n    }\n    else {\n      showError(`${newName} already has an identical entry in the phone book!`)\n    }\n\n  }\n\n  const addName = (event) => { \n    event.preventDefault()\n    if (!newName) {\n      showError(\"Name field is mandatory!\")\n      return\n    }\n    const existing = persons.find(p => p.name == newName) \n    if (existing) {\n      return updateExisting(existing)\n    }\n\n    const newP = {name:newName, number: newPhone ? newPhone : \"-\"}\n    const names = [...persons, newP ]\n\n    jsonservfuncs.addEntry(newP)\n    .then((resp)=> {\n      console.log(resp)\n      setPersons([...persons, resp])\n      showMessage(`Succesfully added ${resp.name}!`)\n    })\n    .catch(err => {\n      console.log(err.response)\n      showError(`${err.response.data.error}`)\n    })\n\n\n  }\n\n  const deletePerson = (person) => {\n    const ans = window.confirm(`Delete ${person.name} from phone book?`)\n    if (!ans) return\n    jsonservfuncs.deletePerson(person.id)\n    .then( (e)=>{\n      jsonservfuncs.getAll().then(\n        (resp) => {\n          setPersons(resp)\n          showMessage('Delete successful!')\n        }\n      )\n    }\n    ).catch((e) => {\n      if (e.response.status == 404) {\n        setPersons(persons.filter(p => p.id !== person.id))\n        showError(`Entry ${person.name} already deleted!`)\n      }\n    })\n  }\n\n  const filterFunc = (p) => p.name.toLowerCase().search(filter.toLowerCase()) >= 0\n\n  return (\n    <div>\n      <Notification notification={notification}/>\n      <h2>Phonebook</h2>\n        <Filter filter={filter} changeHandler={(event) => { setFilter(event.target.value) }}/>\n      <h3>Add new entry</h3>\n        <AddPersonDialog curName={newName} nameChangeHandler={setNewName} curPhone={newPhone} phoneChangeHandler={setNewPhone} submitHandler={addName}/>\n      <h3>Numbers</h3>\n        <People persons={persons} filterfunc={filterFunc} delfunc={deletePerson} />\n    </div>\n  )\n\n}\n\nReactDOM.render(<App />, \n  document.getElementById('root')\n)\n"],"sourceRoot":""}